<!DOCTYPE html>
<html>

<head>
    <title>MultMaps</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
</head>

<body>
    <div id="map0" style="width: 600px; height: 300px"></div>
    </br>
    <div id="map1" style="width: 600px; height: 300px"></div>
    </br>
    <div id="map2" style="width: 600px; height: 300px"></div>
    <!--<div id="map3" style="width: 200px; height: 200px"></div>
    <div id="map4" style="width: 200px; height: 200px"></div>
    <div id="map5" style="width: 200px; height: 200px"></div> -->

    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>

    <script>
        var mapCount = 3;
        var mapArray = [];
        var handle;
        var mapCurrent;

        createMaps();
        setListeners();

        function createMaps() {
            console.log(">>>> create maps");
            for (var i = 0; i < mapCount; i++) {
                mapArray[i] = L.map('map' + i).setView([51.505, -0.09], 13);

                L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
                    maxZoom: 18,
                    id: 'examples.map-i875mjb7'
                }).addTo(mapArray[i]);
            }
        }


        function setListeners() {
            console.log(">>>>>>>>>>>>>>>>>> set listeners");

            function onMapMove(e) {
                var clickedMap = e.target._container.id;
                var mapNum = clickedMap.slice(3, 4);
                var newZoom = mapArray[mapNum].getZoom();
                var newCenter = mapArray[mapNum].getCenter();
                for (var i = 0; i < mapCount; i++) {
                    // console.log(i);

                    mapArray[i].off('move', onMapMove);
                    if (i != mapNum) {
                        mapArray[i].setView(newCenter, newZoom);
                    }
                }
                //for (var i = 0; i < mapCount; i++) {

                mapArray[mapNum].on('move', onMapMove);
                /*            for (var i = 0; i < mapCount; i++) {

                            mapArray[i].on('moveend', function(e) {

                                console.log("focus" + i);
                            });
                        }*/
                //}

            }
            for (var i = 0; i < mapCount; i++) {

                mapArray[i].on('move', onMapMove);
            }



            mapArray[0].on('focus', function (e) {
                mapCurrent = e.target._container.id;
                console.log("focus " + mapCurrent);
            });
            mapArray[1].on('focus', function (e) {
                mapCurrent = e.target._container.id;
                console.log("focus " + mapCurrent);
            });
            mapArray[2].on('focus', function (e) {
                mapCurrent = e.target._container.id;
                console.log("focus " + mapCurrent);
            });
            for (var i = 0; i < mapCount; i++) {
                //if (bool == true) {
                var divId = "map" + i;
                var mapDiv = document.getElementById(divId);
                console.log(div);
                mapDiv.addEventListener("mouseover", function () {
                    //on(div, "mouseover", function (e) {
                    mapArray[0].on('zoomstart', function (e) {
                        console.log(e);
                        mapCurrent = e.target._container.id;
                        if (mapCurrent = div) {
                            console.log("zoomstart " + mapCurrent);
                        }
                    });
                    mapArray[1].on('zoomstart', function (e) {
                        mapCurrent = e.target._container.id;
                        if (mapCurrent = div) {
                            console.log("zoomstart " + mapCurrent);

                        }
                    });
                    mapArray[2].on('zoomstart', function (e) {
                        mapCurrent = e.target._container.id;
                        if (mapCurrent = div) {
                            console.log("zoomstart " + mapCurrent);

                        }
                    });
                });
            }






            /*        for (var i = 0; i < mapCount; i++) {
                    //console.log("init Handler loop " + i);
                    mapArray[i].on('focus', function() {
                        console.log("map " + i);
                    });
                }*/
            /*        mapArray[0].on('moveend', function(e) {

                    console.log("focus" + 0);
                });*/


        }






         //for (var i = 0; i < mapCount; i++) {

         //}



        /*        function setListeners() {
            console.log(">>>>>>>>>>>>>>>>>> set listeners");

            function onMapMove(e) {
                var clickedMap = e.target._container.id;
                console.log("moved " + clickedMap);
                var mapNum = clickedMap.slice(3, 4);
                var newZoom = mapArray[mapNum].getZoom();
                var newCenter = mapArray[mapNum].getCenter();
                for (var i = 0; i < mapCount; i++) {
                    if (i != mapNum) {
                        console.log(i);
                        mapArray[i].setView(newCenter, newZoom);
                    }
                }

            }
            for (var i = 0; i < mapCount; i++) {
                console.log("init Handler loop " + i);
                mapArray[i].on('move', onMapMove);
            }
            mapArray[1].on('moveend', function() {
                mapArray[1].off('move', onMapMove);

                console.log("moveend");
            });
        }*/
    </script>
</body>

</html>
