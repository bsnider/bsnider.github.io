<!DOCTYPE html>
<html>

<head>
    <title>MultMaps</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
</head>

<body>
    <div id="map0" style="width: 600px; height: 400px"></div>
    </br>
    <div id="map1" style="width: 600px; height: 400px"></div>
    <!--     <div id="map2" style="width: 200px; height: 200px"></div>
    <div id="map3" style="width: 200px; height: 200px"></div>
    <div id="map4" style="width: 200px; height: 200px"></div>
    <div id="map5" style="width: 200px; height: 200px"></div> -->

    <script src="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.js"></script>

    <script>
    var mapCount = 2;
    var mapArray = [];
    var handle;

    createMaps();
    setListeners();

    function createMaps() {
        console.log(">>>> create maps");
        for (var i = 0; i < mapCount; i++) {
            mapArray[i] = L.map('map' + i).setView([51.505, -0.09], 13);

            L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', {
                maxZoom: 18,
                id: 'examples.map-i875mjb7'
            }).addTo(mapArray[i]);
        }
    }


    function setListeners() {
        console.log(">>>>>>>>>>>>>>>>>> set listeners");

        function onMapMove(e) {
            var clickedMap = e.target._container.id;
            var mapNum = clickedMap.slice(3, 4);
            for (var i = 0; i < mapCount; i++) {
                mapArray[i].off('move', onMapMove);
                if (i != mapNum){
                    console.log("move" + 1);
                    var newZoom = mapArray[1].getZoom();
                    var newCenter = mapArray[1].getCenter();
                    mapArray[0].setView(newCenter, newZoom);
                }
            }
            for (var i = 0; i < mapCount; i++) {
                mapArray[i].on('move', onMapMove);
            }
             
        }


        function onMapMove(e) {
            var clickedMap = e.target._container.id;
            var mapNum = clickedMap.slice(3, 4);
            for (var i = 0; i < mapCount; i++) {
                mapArray[i].off('move', onMapMove);
                if (i != mapNum){
                    console.log("move" + i);
                    var newZoom = mapArray[i].getZoom();
                    var newCenter = mapArray[i].getCenter();
                    mapArray[i].setView(newCenter, newZoom);
                }
            }
            for (var i = 0; i < mapCount; i++) {
                mapArray[i].on('move', onMapMove);
            }
                        

        }
        mapArray[1].on('move', onMapMove);





        //mapArray[1].on('move', onMapMove);

        //function onMapMoveEnd(e) {

            /*//handle.remove();
            console.log(handle);

            var clickedMap = e.target._container.id;
            var mapNum = clickedMap.slice(3, 4);
            " + mapNum);
            var newZoom = mapArray[1].getZoom();
            var newCenter = mapArray[1].getCenter();
            //mapArray[0].setView(newCenter, newZoom);*/
            //console.log("MoveEnd: ");
        //}
        //mapArray[1].on('moveend', onMapMoveEnd);
    }





    /*        function onMapMoveEnd(e) {
                handle.remove();
                console.log(handle);
                //console.log(e.target._container.id);
                console.log("MoveEnd" + 1);
                var newZoom = mapArray[1].getZoom();
                var newCenter = mapArray[1].getCenter();
                mapArray[0].setView(newCenter, newZoom);
            }
            mapArray[1].on('moveend', onMapMoveEnd);*/
/* function onMapFocus(e) { //console.log(e.target._container.id); console.log("focus" + 1); } mapArray[1].on('focus', onMapFocus); function onMapBlur(e) { //console.log(e.target._container.id); console.log("blur" + 1); } mapArray[1].on('blur', onMapBlur); */ /* var mapDiv; var handle; var f = 0; var bool1 = true; var bool2; var myBox; var handleOver; var handleOut; var handleUp; var handleDown; var map0 = L.map('map0').setView([51.505, -0.09], 13); L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', { maxZoom: 18, id: 'examples.map-i875mjb7' }).addTo(map0); function onMapMove(e) { //console.log(e.target._container.id); // console.log("moved"); } map0.on('moveend', onMapMove); function onMapFocus0(e) { //console.log(e.target._container.id); console.log("focus0"); } map0.on('focus', onMapFocus0); ///////////////////////////////////////////////////////// var map1 = L.map('map1').setView([51.505, -0.09], 13); L.tileLayer('https://{s}.tiles.mapbox.com/v3/{id}/{z}/{x}/{y}.png', { maxZoom: 18, id: 'examples.map-i875mjb7' }).addTo(map1); function onMapMove(e) { //console.log(e.target._container.id); //console.log("moved"); } map1.on('moveend', onMapMove); function onMapFocus1(e) { //console.log(e.target._container.id); console.log("focus1"); } map1.on('focus', onMapFocus1);*/

    </script>
</body>

</html>
